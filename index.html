<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TGCC Explorer - Homepage </title>
    <meta name="description" content="" />
    <meta name="keywords" content="bitcoin, ethereum, monero, ico, token, free token, btc, eth" />
    <meta name="author" content="TGCC" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/images/favicon.png" />

    <!-- Bootstrap & Plugins CSS -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- Custom CSS -->
    <link href="assets/css/purple.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="assets/css/public.css">
    <link rel="stylesheet" href="assets/layui/css/layui.css">

</head>

<body>

    <div class="loading-wrapper">
        <div class="loading">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <!-- ***** Header Area Start ***** -->
    <header class="header-area">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="main-nav">
                        <!-- ***** Logo Start ***** -->
                        <a href="index.html" class="logo">
                            <!-- <img src="assets/images/logos/transparent-logo-purple.svg" class="light-logo" alt="SGU CHAIN"/>
								<img src="assets/images/logos/white-logo-purple.svg" class="dark-logo" alt="SGU CHAIN"/> -->
                            <img src="assets/images//logos/logo.png" class="light-logo" alt="TGCC CHAIN" />
                            <img src="assets/images/logos/logo.png" class="dark-logo" alt="TGCC CHAIN" />
                        </a>
                        <!-- ***** Logo End ***** -->

                        <!-- ***** Lang Start ***** -->
                        <div class="lang">


                            <div class="selected">
                                <img src="assets/images/flags/china.png" alt="">
                                <i class="fa fa-angle-down"></i>
                            </div>
                            <!-- <select class="trans-en">
									<option value="简体中文">简体中文</option>
									<option value="English">English</option>
								</select> -->

                            <ul class="flag-list trans-en">
                                <li class="chinese-language">
                                    <a href="#">
                                        <img src="assets/images/flags/china.png" alt="">
                                        <span>简体中文</span>
                                    </a>
                                </li>
                                <li class="english-language">
                                    <a href="#">
                                        <img src="assets/images/flags/en.png" alt="">
                                        <span>English</span>
                                    </a>
                                </li>
                            </ul>

                        </div>
                        <!-- ***** Lang End ***** -->

                        <!-- ***** Menu Start ***** -->
                        <ul class="nav">
                            <li>
                                <a href="index.html">
                                    <span i18n="i18n.themselves">首页</span>
                                </a>
                            </li>
                            <li>
                                <a href="wallet-list.html">
                                    <span i18n="i18n.successful-case">钱包</span>
                                </a>
                            </li>
                            <li>
                                <a href="transaction-list.html">
                                    <span i18n="i18n.Intelligence-test">交易</span>
                                </a>
                            </li>
                            <li>
                                <a href="block-list.html">
                                    <span i18n="i18n.evaluation">区块</span>
                                </a>
                            </li>


                        </ul>
                        <a class='menu-trigger'>
                            <span>Menu</span>
                        </a>
                        <!-- ***** Menu End ***** -->
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- ***** Header Area End ***** -->

    <!-- ***** Wellcome Area Start ***** -->
    <section class="block-explorer-wrapper bg-bottom-center" id="welcome-1">
        <div class="block-explorer text">
            <div class="container text-center">
                <div class="row">
                    <div class="col-lg-12 align-self-center">
                        <h1 i18n="i18n.Block browser">区块浏览器</h1>
                    </div>
                    <div class="offset-lg-3 col-lg-6">
                        <div style="display: flex;
                            justify-content: center;">
                            <p i18n="i18n.LatestBlockID">最新区块: </p><span style="padding-top: 6px;" class="latestBlockOfHead color-fff"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="search">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="input-wrapper">
                            <div class="input">
                                <input type="text" id="findContent" class="search-box" i18n="i18n.Please enter what you are looking for" placeholder="请输入您想查找的内容.">

                                <button class="search-btn"><i class="fa fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- ***** Wellcome Area End ***** -->



    <!-- 最新数据 -->
    <section class="block-explorer-features section pt-5 pb-0  mt-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="section-title mb-4" i18n="i18.latest data">最新数据</h3>
                </div>
            </div>
            <div class="row" id="latestData">
                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                    <div class="item">
                        <div class="title">
                            <div class="icon"></div>

                            <h5 i18n="i18n.altitude">高度</h5>
                        </div>
                        <div class="text">
                            <span>-- <i class="green fa fa-long-arrow-up"></i></span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                    <div class="item">
                        <div class="title">
                            <div class="icon"></div>

                            <h5 i18n="i18n.supply">供应</h5>
                        </div>
                        <div class="text">
                            <span>0</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                    <div class="item">
                        <div class="title">
                            <div class="icon"></div>

                            <h5 i18n="i18n.account">账户</h5>
                        </div>
                        <div class="text">
                            <span>0名</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12" id="latestDataOne">
                    <div class="item">
                        <div class="title">
                            <div class="icon"></div>

                            <h5 i18n="i18n.node">节点</h5>
                        </div>
                        <div class="text">
                            <span>0个</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- end -->

    <!-- table Start -->
    <section class="block-explorer-section section p-0 m-0">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 padding-bottom">
                    <h3 class="section-title mb-4" i18n="i18n.Latest blockchain">最新区块</h3>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="">
                        <table class="table table-striped table-latests table-responsive-stack alert-warning">
                            <thead>
                                <tr>
                                    <td i18n="i18n.ID">ID</td>
                                    <td i18n="i18n.altitude">高度</td>
                                    <td i18n="i18n.timestamp">时间戳</td>
                                    <td i18n="i18n.Intelligence-test">交易</td>
                                    <!-- <td i18n="i18n.producer">生成者</td> -->
                                    <!-- <td i18n="i18n.The piece reward">出块奖励</td> -->
                                    <td i18n="i18n.service charge">手续费</td>
                                </tr>
                            </thead>
                            <!-- 列表渲染 -->
                            <tbody class="tbody-style" id="latestBlockchainNews">
                                <tr>
                                    <td colspan="7">暂无区块</td>

                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="row flex flex-center mt-3 mb-3">
                <a href="./block-list.html">
                    <div class="more-btn flex flex-center" i18n="i18n.MoreBlocks" id="moreInfo1">更多区块信息

                    </div>
                </a>
            </div>
        </div>
    </section>
    <!-- table End -->

    <!-- table Start -->
    <section class="block-explorer-section section p-0 m-0">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="section-title mb-4" i18n="i18n.practice">最新交易
                    </h3>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="">
                        <table class="table table-striped table-latests table-responsive-stack alert-warning">
                            <thead>
                                <tr>
                                    <td i18n="ID">ID</td>
                                    <td i18n="i18n.timestamp">时间戳</td>
                                    <td i18n="i18n.dispatcher">发送者</td>
                                    <td i18n="i18n.receiver">接收者</td>
                                    <td i18n="i18n.amount">数量</td>
                                    <td i18n="i18n.cost">费用</td>
                                </tr>
                            </thead>
                            <tbody class="tbody-style" id="latesTransactions">
                                <tr>
                                    <td colspan="6">暂无交易</td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="row flex flex-center mt-3 mb-3">
                <div class="more-btn flex flex-center text-center" i18n="i18n.MoreTransactions" id="moreInfo2">
                    更多交易信息</div>
            </div>
        </div>
    </section>
    <!-- table End -->

    <!-- ***** Contact & Footer Start ***** -->
    <footer id="contact">
        <div class="footer-bottom slim">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <p class="copyright">2019 © by TGCC</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- ***** Contact & Footer End ***** -->


    <!-- jQuery -->
    <script src="assets/js/jquery-2.1.0.min.js"></script>
    <script src="./assets/js/jquery.i18n.properties.min.js"></script>
    <!-- dbData -->
    <script src="assets/js/dbData.js"></script>


    <!-- Bootstrap -->
    <script src="assets/js/popper.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>

    <!-- Plugins -->
    <script src="assets/js/particles.min.js"></script>
    <script src="assets/js/scrollreveal.min.js"></script>
    <script src="assets/js/jquery.downCount.js"></script>
    <script src="assets/js/parallax.min.js"></script>

    <!-- Global Init -->
    <script src="assets/js/particle-purple.js"></script>
    <script src="assets/js/custom.js"></script>


    <!-- jquery.i18n.js -->
    <script src="assets/js/jquery.i18n.js"></script>
    <script src="assets/layui/layui.all.js"></script>

    <script src="assets/js/app.js"></script>


    <script>
        $(document).ready(function() {
            var BURL = 'http://124.70.148.13:4103/api/'

            var getLastestNetwork = function() {
                $.ajax({
                    //请求方式
                    type: "GET",
                    //请求的媒体类型
                    contentType: "application/json;charset=UTF-8",
                    //请求地址
                    url: BURL + "v2/blockchain",


                    //请求成功
                    success: function(result) {
                        console.log(result);
                        var res = result.data
                        console.log(res.length)
                        $.ajax({
                            type: "GET",
                            //请求的媒体类型
                            contentType: "application/json;charset=UTF-8",
                            //请求地址
                            url: BURL + "v2/wallets/top?limit=25&page=1",
                            success: function(res) {
                                console.log('aa');
                                console.log(res.meta.totalCount);
                                totalCountA = res.meta.totalCount;
                                $("#totalCountA").text(totalCountA)
                            }

                        })

                        var latestBlockchain = `
                                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12" id="${res.block.id}">
                                    <div class="item">
                                        <div class="title">
                                            <div class="icon"></div>
                                            
                                            <h5 i18n="i18n.altitude">高度</h5>
                                        </div>
                                        <div class="text">
                                            <span>${res.block.height}<i class="green fa fa-long-arrow-up"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <div class="item">
                                        <div class="title">
                                            <div class="icon"></div>
                                        
                                            <h5 i18n="i18n.supply">供应</h5>
                                        </div>
                                        <div class="text">
                                            <span>${(res.supply / Math.pow(10, 8))} T</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <div class="item">
                                        <div class="title">
                                            <div class="icon"></div>
                                        
                                            <h5 i18n="i18n.account">账户</h5>
                                        </div>
                                        <div class="text">
                                            <span id="totalCountA"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-3 col-md-6 col-sm-6 col-xs-12">
                                    <div class="item">
                                        <div class="title">
                                            <div class="icon"></div>
                                        
                                            <h5 i18n="i18n.node">节点</h5>
                                        </div>
                                        <div class="text">
                                            <span id="vnode"></span>
                                        </div>
                                    </div>
                                </div>
                                `;
                        $("#latestData").html(latestBlockchain)
                            // for (let i = 0; i < res.length; i++) {
                            //  console.log(res.length)
                            //  const element = res[i];
                            //  console.log('1212')
                            //  console.log(element)
                            // }

                        $.ajax({
                            //请求方式
                            type: "GET",
                            //请求的媒体类型
                            contentType: "application/json;charset=UTF-8",
                            //请求地址
                            url: BURL + "v2/delegates",
                            //请求成功
                            success(res) {
                                console.log(res.meta.count);
                                var vnode = res.meta.count;
                                console.log(vnode);
                                $("#vnode").text(vnode);

                            }
                        });

                        $.refreshLang();

                    },
                    //请求失败，包含具体的错误信息
                    error: function(e) {
                        console.log(e.status);
                        console.log(e.responseText);
                    }
                });
            }

            var getLatestBlocks = function() {
                $.ajax({
                    type: "GET",
                    // dataType:"jsonp",
                    contentType: "application/json;charset=UTF-8",
                    // url: BURL + "v2/blocks?orderBy=height:desc&limit=6",
                    url: BURL + `v2/blocks?limit=6`,
                    crossDomain: "true"

                }).done(res => {
                    // console.log(res.data);
                    console.log(res.data.length); //让表单只有6条数据
                    let resArr = res.data;
                    var latestBlockchainNews = '';
                    resArr.forEach(ele1 => {
                        function p(s) {
                            return s < 10 ? '0' + s : s
                        }
                        var d = new Date(ele1.timestamp.human)
                        var datetime = d.getFullYear() + '-' + p((d.getMonth() + 1)) + '-' + p(d.getDate()) + ' ' + p(d.getHours()) + ':' + p(d.getMinutes()) + ':' + p(d.getSeconds());
                        // console.log(ele);
                        latestBlockchainNews += `
                            <tr>
                                <td><a class="latestBlockchainNews" id="${ele1.id}">${ele1.id}</a></td>
                                <td>${ele1.height}</td>
                                <td>${datetime}</td>
                                <td>${ele1.transactions}</td>
                                <td>0T</td>
                            </tr>
                            `
                    });
                    $("#latestBlockchainNews").html(latestBlockchainNews);



                    $("tbody > tr > td > a.latestBlockchainNews").click(function(e) {
                        // console.log(e.target.id)
                        var hrefID = e.target.id;

                        // 这个是获取接口数据------用这个❤️   目前取值，你要输入 15447090855222023348  就是有值得
                        localStorage.setItem("blockId", e.target.id);
                        window.location.href = `block-detail.html?id=${hrefID}`



                        //api接口的真确的数据
                        // window.location.href = `newestOne.html?id=15447090855222023348`
                        // localStorage.setItem("blockId", "15447090855222023348");



                    })
                }).fail(err => {

                })
            }


            var getLatestTransactions = function() {
                //最新交易 v2/transactions?orderBy=timestamp:desc&limit=25
                $.ajax({
                    type: "GET",
                    contentType: "application/json;charset=UTF-8",
                    // url: BURL + "v2/transactions?orderBy=timestamp:desc&limit=6",
                    url: BURL + `v2/transactions?limit=6`,
                    success(res) {
                        console.log(res.data);
                        console.log(res.data.length);
                        let resArr = res.data;
                        let latesTransactions = '';
                        resArr.forEach(ele => {
                            console.log(ele);

                            function p(s) {
                                return s < 10 ? '0' + s : s
                            }
                            var d = new Date(ele.timestamp.human)
                            var datetime = d.getFullYear() + '-' + p((d.getMonth() + 1)) + '-' + p(d.getDate()) + ' ' + p(d.getHours()) + ':' + p(d.getMinutes()) + ':' + p(d.getSeconds());
                            latesTransactions += `
                            <tr>
                             <td class="transactions-id-de"><a id="${ele.id}">${ele.id.slice(0,16)}...</a></td>
                             <td>${datetime}</td>
                             <td><a href="wallet-detail.html?id=${ele.sender}"> ${getAddressUsername(ele.sender)}</a></td>
                             <td><a href="wallet-detail.html?id=${ele.recipient}"> ${getAddressUsername(ele.recipient)}  </a></td>
                             <td>${ele.amount / Math.pow(10, 8).toFixed(2)}T </td>
                             <td>${ele.fee / Math.pow(10, 8).toFixed(2)}T </td>
                            </tr>
                            `
                        });
                        $("#latesTransactions").html(latesTransactions);
                        $("tbody > tr> td.transactions-id-de").click(function(e) {
                            var transactionsIDID = e.target.id;
                            localStorage.setItem("transactionsIDID", e.target.id);
                            window.location.href = `transaction-detail.html?id=${transactionsIDID}`
                        })

                    },
                    error(err) {
                        console.log(err);
                    }

                })
            }

            getLastestNetwork();
            getLatestBlocks();
            getLatestTransactions();


            var timer = window.setInterval(function() {
                getLastestNetwork();
                getLatestBlocks();
                getLatestTransactions();
            }, 10000)

            document.addEventListener("visibilitychange", function() {

                　　
                if (document.hidden) {

                    　　　　　
                    clearInterval(timer);

                    　　　
                }

            });


        });

        $("#moreInfo1").click(function() {
            window.location.href = "block-list.html"
        })

        $("#moreInfo2").click(function() {
            window.location.href = "transaction-list.html"
        })
    </script>

</body>

</html>